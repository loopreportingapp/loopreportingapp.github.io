<!doctype html>
<html lang="en">
    <head>
        <title>PNG LOOP | Reporting App | Home Page</title>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="d3.min.js"></script>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="../style.css">
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine" />
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Oswald" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

    </head>

    <body>
        <div id="wrapper" class="container">
        <header class="container">
            <a href="index.html" ><img src="img/logo21.png" /></a>
            <a href="index.html" ><h1 id="site-title">reporting application</h1></a>
        </header>
       <nav class="navbar navbar-default">
   <nav class="navbar navbar-inverse">
  <div class="container-fluid text-uppercase">
    <div class="navbar-header">
      <a class="navbar-brand" href="about.html">Reporting app</a>
    </div>
    <div>
      <ul class="nav navbar-nav">
        <li class="active"><a href="index.html">Home</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">2014 Reports
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="reports/dec-00.html">December</a></li>
            <li><a href="#">November</a></li>
            <li><a href="#">October</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">2015 Reports
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">January</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
<!-- nav ends -->
<div class="container">
    <div>
        <h2 class="text-title">practical - using real data (dec-00.json)</h2>
    </div>
</div>
<div class="container">
    <div class="col-md-1"></div>
    <div class="col-md-10" style="padding: 1em 2em 1em 2em;" >
        <div id="chart"></div>
    </div>
    <div class="col-md-1"></div>
</div>
<div class="container"><p class="text-warning text-right">slyvestery <a href="http://www.twitter.com/sudodez">@sudodez</a></p></div>
    </body>
    <script>
      var w = 895, h = 450;
      d3.json("data/dec-00.json", function(data){
        
        var margLeft, margRight = w - 25;
        var margTop, margBottom = h - 25;

        var colors = d3.scale.category20();

        var highestValueInDataset;
          // highestValueInDataset = d3.max(data, function (d) { return d[1]; });
          highestValueInDataset = 150;

        var heightScale = d3.scale.linear()
          .domain([0,highestValueInDataset])
          .range([0,h]);

        var widthScale = d3.scale.linear()
          .domain([25,((w-25)/data.length)])
          .range([(w/data.length),(w/data.length)]);

        var xScale = d3.scale.linear()
          .domain([0,highestValueInDataset])
          .range([0,w]);

        var yScale = d3.scale.linear()
          .domain([0, highestValueInDataset])
          .range([0,h]);

        var xAxis = d3.svg.axis();
        xAxis.scale(xScale)
          .orient("bottom")
          .ticks(0);

        var yAxis = d3.svg.axis();
        yAxis.scale(yScale)
          .orient("right")
          .ticks(5);

        var canvas = d3.select("#chart").append("svg")
          .attr("width",w)
          .attr("height",h)
          .append("g")
          .attr("transform","translate(0,0)")
          .attr("width",w-25);

        var bars = canvas.append("g").selectAll("rect")
          .data(data)
          .enter()
            .append("rect")
            .attr("x",function (d,i) {
              return i*(w/data.length);
            })
            .attr("y",function (d){
              return (h - heightScale(d.COUNT));
            })
            .attr("height",function (d){
              return heightScale(d.COUNT);
            })
            .attr("width", function (d,i) {
              return widthScale(20) - 5;
            })
            .attr("fill", function (d){
              return colors(d.COUNT);
            });
        
        var texts = canvas.append("g").selectAll("text")
          .data(data)
          .attr("class","data-label")
          .enter()
            .append("text")
            .text(function (d){
              return d.COUNT;
            })
            .attr("x",function (d,i){
              return (i * (w/data.length)) + ((w/data.length)/3);// return (data.length) + (i * 25);
            })
            .attr("y",function (d) {
              return h - heightScale(d.COUNT) + 25;
            })
            .attr("fill","yellow");

        canvas.append("g")
          .attr("fill","maroon")
          .attr("transform","translate(-1.5,445)")
          .call(xAxis);

      })
    </script>
</html>